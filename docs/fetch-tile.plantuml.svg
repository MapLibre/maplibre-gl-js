<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2194px" preserveAspectRatio="none" style="width:1467px;height:2194px;" version="1.1" viewBox="0 0 1467 2194" width="1467px" zoomAndPan="magnify"><defs><filter height="300%" id="f1xd26i49gx5lv" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="2179.8496" style="stroke: #A80036; stroke-width: 1.0;" width="632" x="807" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="1099.5" y="16.5684">worker</text><rect fill="#FFFFFF" filter="url(#f1xd26i49gx5lv)" height="1496.1055" style="stroke: #000000; stroke-width: 2.0;" width="1151" x="304" y="231.6621"/><rect fill="#FFFFFF" height="59.5762" style="stroke: none; stroke-width: 1.0;" width="1151" x="304" y="278.2832"/><rect fill="#FFFFFF" height="145.1973" style="stroke: none; stroke-width: 1.0;" width="1151" x="304" y="337.8594"/><rect fill="#FFFFFF" height="1244.7109" style="stroke: none; stroke-width: 1.0;" width="1151" x="304" y="483.0566"/><rect fill="#FFFFFF" filter="url(#f1xd26i49gx5lv)" height="260.1289" style="stroke: #000000; stroke-width: 2.0;" width="548.5" x="896.5" y="563.6328"/><rect fill="#FFFFFF" height="128.8867" style="stroke: none; stroke-width: 1.0;" width="548.5" x="896.5" y="694.875"/><rect fill="#FFFFFF" filter="url(#f1xd26i49gx5lv)" height="766.7637" style="stroke: #000000; stroke-width: 2.0;" width="871.5" x="517.5" y="867.0723"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="47" x2="47" y1="58.7988" y2="2128.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="184" x2="184" y1="58.7988" y2="2128.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="346" x2="346" y1="58.7988" y2="2128.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="550.5" x2="550.5" y1="58.7988" y2="2128.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="688.5" x2="688.5" y1="58.7988" y2="2128.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="844" x2="844" y1="58.7988" y2="2128.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="965.5" x2="965.5" y1="58.7988" y2="2128.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1088" x2="1088" y1="58.7988" y2="2128.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1250" x2="1250" y1="58.7988" y2="2128.873"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1384" x2="1384" y1="58.7988" y2="2128.873"/><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="23" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="30" y="43.8457">map</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="23" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="30" y="2148.4082">map</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="129" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="136" y="43.8457">source_cache</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="129" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="136" y="2148.4082">source_cache</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="314" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="321" y="43.8457">source</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="314" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="321" y="2148.4082">source</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="527.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="534.5" y="43.8457">ajax</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="527.5" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="534.5" y="2148.4082">ajax</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="636.5" y="6.8223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="643.5" y="27.3574">glyph/image</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="656.5" y="43.8457">manager</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="636.5" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="643.5" y="2148.4082">glyph/image</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="656.5" y="2164.8965">manager</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="811" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="818" y="43.8457">worker</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="811" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="818" y="2148.4082">worker</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="906.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="913.5" y="43.8457">worker_source</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="906.5" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="913.5" y="2148.4082">worker_source</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="1041" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="1048" y="43.8457">worker_tile</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="1041" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="1048" y="2148.4082">worker_tile</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1218" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1225" y="43.8457">bucket</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1218" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1225" y="2148.4082">bucket</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="1333" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="1340" y="43.8457">worker_ajax</text><rect fill="#FEFECE" filter="url(#f1xd26i49gx5lv)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="1333" y="2127.873"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="1340" y="2148.4082">worker_ajax</text><polygon fill="#A80036" points="172,86.1094,182,90.1094,172,94.1094,176,90.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="47" x2="178" y1="90.1094" y2="90.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="54" y="85.3672">update(transform)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="184" x2="226" y1="150.041" y2="150.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="226" x2="226" y1="150.041" y2="163.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="185" x2="226" y1="163.041" y2="163.041"/><polygon fill="#A80036" points="195,159.041,185,163.041,195,167.041,191,163.041" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="191" y="114.6777">compute</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="191" y="129.9883">covering</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="191" y="145.2988">tiles</text><polygon fill="#A80036" points="334,212.6621,344,216.6621,334,220.6621,338,216.6621" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="184" x2="340" y1="216.6621" y2="216.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="191" y="211.9199">loadTile(tile, callback)</text><path d="M304,231.6621 L366,231.6621 L366,238.6621 L356,248.6621 L304,248.6621 L304,231.6621 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1496.1055" style="stroke: #000000; stroke-width: 2.0;" width="1151" x="304" y="231.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="319" y="245.2305">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="381" y="244.2969">[raster_tile_source]</text><polygon fill="#A80036" points="539,266.2832,549,270.2832,539,274.2832,543,270.2832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="545" y1="270.2832" y2="270.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="353" y="265.541">getImage</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="304" x2="1455" y1="279.2832" y2="279.2832"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="309" y="289.918">[image_source]</text><polygon fill="#A80036" points="539,325.8594,549,329.8594,539,333.8594,543,329.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="545" y1="329.8594" y2="329.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="353" y="309.8066">getImage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="353" y="325.1172">(once)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="304" x2="1455" y1="338.8594" y2="338.8594"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="309" y="349.4941">[raster_dem_tile_source]</text><polygon fill="#A80036" points="539,370.125,549,374.125,539,378.125,543,374.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="545" y1="374.125" y2="374.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="353" y="369.3828">getImage()</text><polygon fill="#A80036" points="832,399.4355,842,403.4355,832,407.4355,836,403.4355" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="838" y1="403.4355" y2="403.4355"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="353" y="398.6934">loadDEMTile()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="844" x2="886" y1="432.7461" y2="432.7461"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="886" x2="886" y1="432.7461" y2="445.7461"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="845" x2="886" y1="445.7461" y2="445.7461"/><polygon fill="#A80036" points="855,441.7461,845,445.7461,855,449.7461,851,445.7461" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="851" y="428.0039">add 1px buffer</text><polygon fill="#A80036" points="357,471.0566,347,475.0566,357,479.0566,353,475.0566" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="351" x2="843" y1="475.0566" y2="475.0566"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="363" y="470.3145">DEMData</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="304" x2="1455" y1="484.0566" y2="484.0566"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="203" x="309" y="494.6914">[vector_tile_source/geojson_source]</text><polygon fill="#A80036" points="832,515.3223,842,519.3223,832,523.3223,836,519.3223" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="838" y1="519.3223" y2="519.3223"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="353" y="514.5801">loadTile()</text><polygon fill="#A80036" points="954,544.6328,964,548.6328,954,552.6328,958,548.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="844" x2="960" y1="548.6328" y2="548.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="851" y="543.8906">loadVectorTile()</text><path d="M896.5,563.6328 L958.5,563.6328 L958.5,570.6328 L948.5,580.6328 L896.5,580.6328 L896.5,563.6328 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="260.1289" style="stroke: #000000; stroke-width: 2.0;" width="548.5" x="896.5" y="563.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="911.5" y="577.2012">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="973.5" y="576.2676">[vector_tile_source]</text><polygon fill="#A80036" points="1372,598.2539,1382,602.2539,1372,606.2539,1376,602.2539" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="966" x2="1378" y1="602.2539" y2="602.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="973" y="597.5117">getArrayBuffer()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="966" x2="1008" y1="631.5645" y2="631.5645"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1008" x2="1008" y1="631.5645" y2="644.5645"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="967" x2="1008" y1="644.5645" y2="644.5645"/><polygon fill="#A80036" points="977,640.5645,967,644.5645,977,648.5645,973,644.5645" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="973" y="626.8223">decode pbf</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="966" x2="1008" y1="673.875" y2="673.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1008" x2="1008" y1="673.875" y2="686.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="967" x2="1008" y1="686.875" y2="686.875"/><polygon fill="#A80036" points="977,682.875,967,686.875,977,690.875,973,686.875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="973" y="669.1328">parse vector tile</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="896.5" x2="1445" y1="695.875" y2="695.875"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="901.5" y="706.5098">[geojson_source]</text><polygon fill="#A80036" points="1372,727.1406,1382,731.1406,1372,735.1406,1376,731.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="966" x2="1378" y1="731.1406" y2="731.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="973" y="726.3984">getJSON()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="966" x2="1008" y1="760.4512" y2="760.4512"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1008" x2="1008" y1="760.4512" y2="773.4512"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="967" x2="1008" y1="773.4512" y2="773.4512"/><polygon fill="#A80036" points="977,769.4512,967,773.4512,977,777.4512,973,773.4512" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="973" y="755.709">geojson-vt parse</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="966" x2="1008" y1="802.7617" y2="802.7617"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1008" x2="1008" y1="802.7617" y2="815.7617"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="967" x2="1008" y1="815.7617" y2="815.7617"/><polygon fill="#A80036" points="977,811.7617,967,815.7617,977,819.7617,973,815.7617" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="973" y="798.0195">getTile()</text><polygon fill="#A80036" points="1076,848.0723,1086,852.0723,1076,856.0723,1080,852.0723" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="966" x2="1082" y1="852.0723" y2="852.0723"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="973" y="847.3301">parse()</text><path d="M517.5,867.0723 L591.5,867.0723 L591.5,874.0723 L581.5,884.0723 L517.5,884.0723 L517.5,867.0723 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="766.7637" style="stroke: #000000; stroke-width: 2.0;" width="871.5" x="517.5" y="867.0723"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="532.5" y="880.6406">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="606.5" y="879.707">[for each "layer family"]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1088" x2="1130" y1="921.0039" y2="921.0039"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1130" x2="1130" y1="921.0039" y2="934.0039"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1089" x2="1130" y1="934.0039" y2="934.0039"/><polygon fill="#A80036" points="1099,930.0039,1089,934.0039,1099,938.0039,1095,934.0039" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="1095" y="900.9512">calculate layout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="1095" y="916.2617">properties</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1088" x2="1130" y1="963.3145" y2="963.3145"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1130" x2="1130" y1="963.3145" y2="976.3145"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1089" x2="1130" y1="976.3145" y2="976.3145"/><polygon fill="#A80036" points="1099,972.3145,1089,976.3145,1099,980.3145,1095,976.3145" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="1095" y="958.5723">createBucket</text><polygon fill="#A80036" points="1238,1001.625,1248,1005.625,1238,1009.625,1242,1005.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1088" x2="1244" y1="1005.625" y2="1005.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="1095" y="1000.8828">populate()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1250" x2="1292" y1="1080.8672" y2="1080.8672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1292" x2="1292" y1="1080.8672" y2="1093.8672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1251" x2="1292" y1="1093.8672" y2="1093.8672"/><polygon fill="#A80036" points="1261,1089.8672,1251,1093.8672,1261,1097.8672,1257,1093.8672" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="1257" y="1030.1934">compute triangles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="1257" y="1045.5039">needed by GPU</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1257" y="1060.8145">for each feature we</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="1257" y="1076.125">have data for</text><polygon fill="#A80036" points="700,1119.1777,690,1123.1777,700,1127.1777,696,1123.1777" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="694" x2="1087" y1="1123.1777" y2="1123.1777"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="706" y="1118.4355">getGlyphs</text><polygon fill="#A80036" points="562,1148.4883,552,1152.4883,562,1156.4883,558,1152.4883" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="556" x2="688" y1="1152.4883" y2="1152.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="568" y="1147.7461">Fetch font PBFs</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="689" x2="731" y1="1181.7988" y2="1181.7988"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="731" x2="731" y1="1181.7988" y2="1194.7988"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="690" x2="731" y1="1194.7988" y2="1194.7988"/><polygon fill="#A80036" points="700,1190.7988,690,1194.7988,700,1198.7988,696,1194.7988" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="696" y="1177.0566">render TinySDF glyphs</text><polygon fill="#A80036" points="700,1220.1094,690,1224.1094,700,1228.1094,696,1224.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="694" x2="1087" y1="1224.1094" y2="1224.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="706" y="1219.3672">getImages</text><polygon fill="#A80036" points="562,1249.4199,552,1253.4199,562,1257.4199,558,1253.4199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="556" x2="688" y1="1253.4199" y2="1253.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="568" y="1248.6777">Fetch icon images</text><polygon fill="#A80036" points="1076,1278.7305,1086,1282.7305,1076,1286.7305,1080,1282.7305" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="689" x2="1082" y1="1282.7305" y2="1282.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="696" y="1277.9883">hlyph/Image dependencies</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1088" x2="1130" y1="1312.041" y2="1312.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1130" x2="1130" y1="1312.041" y2="1325.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1089" x2="1130" y1="1325.041" y2="1325.041"/><polygon fill="#A80036" points="1099,1321.041,1089,1325.041,1099,1329.041,1095,1325.041" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="1095" y="1307.2988">maybePrepare()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1088" x2="1130" y1="1354.3516" y2="1354.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1130" x2="1130" y1="1354.3516" y2="1367.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1089" x2="1130" y1="1367.3516" y2="1367.3516"/><polygon fill="#A80036" points="1099,1363.3516,1089,1367.3516,1099,1371.3516,1095,1367.3516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="1095" y="1349.6094">create GlyphAtlas</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1088" x2="1130" y1="1396.6621" y2="1396.6621"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1130" x2="1130" y1="1396.6621" y2="1409.6621"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1089" x2="1130" y1="1409.6621" y2="1409.6621"/><polygon fill="#A80036" points="1099,1405.6621,1089,1409.6621,1099,1413.6621,1095,1409.6621" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="1095" y="1391.9199">create ImageAtlas</text><polygon fill="#A80036" points="1238,1434.9727,1248,1438.9727,1238,1442.9727,1242,1438.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1088" x2="1244" y1="1438.9727" y2="1438.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="1095" y="1434.2305">addFeatures</text><polygon fill="#A80036" points="1238,1464.2832,1248,1468.2832,1238,1472.2832,1242,1468.2832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1088" x2="1244" y1="1468.2832" y2="1468.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="1095" y="1463.541">performSymbolLayout</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1250" x2="1292" y1="1497.5938" y2="1497.5938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1292" x2="1292" y1="1497.5938" y2="1510.5938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1251" x2="1292" y1="1510.5938" y2="1510.5938"/><polygon fill="#A80036" points="1261,1506.5938,1251,1510.5938,1261,1514.5938,1257,1510.5938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="1257" y="1492.8516">place characters</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1250" x2="1292" y1="1555.2148" y2="1555.2148"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1292" x2="1292" y1="1555.2148" y2="1568.2148"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1251" x2="1292" y1="1568.2148" y2="1568.2148"/><polygon fill="#A80036" points="1261,1564.2148,1251,1568.2148,1261,1572.2148,1257,1568.2148" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="1257" y="1535.1621">compute collision</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="1257" y="1550.4727">boxes</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1250" x2="1292" y1="1612.8359" y2="1612.8359"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1292" x2="1292" y1="1612.8359" y2="1625.8359"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1251" x2="1292" y1="1625.8359" y2="1625.8359"/><polygon fill="#A80036" points="1261,1621.8359,1251,1625.8359,1261,1629.8359,1257,1625.8359" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="1257" y="1592.7832">compute triangles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="1257" y="1608.0938">needed by GPU</text><polygon fill="#A80036" points="357,1658.1465,347,1662.1465,357,1666.1465,353,1662.1465" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="351" x2="1087" y1="1662.1465" y2="1662.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="363" y="1657.4043">callback(bucket, featureIndex, collision boxes, GlyphAtlas, ImageAtlas)</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="346" x2="388" y1="1706.7676" y2="1706.7676"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="388" x2="388" y1="1706.7676" y2="1719.7676"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="347" x2="388" y1="1719.7676" y2="1719.7676"/><polygon fill="#A80036" points="357,1715.7676,347,1719.7676,357,1723.7676,353,1719.7676" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="353" y="1686.7148">Tile#loadVectorData()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="353" y="1702.0254">decode response</text><polygon fill="#A80036" points="195,1752.0781,185,1756.0781,195,1760.0781,191,1756.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="189" x2="345" y1="1756.0781" y2="1756.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="201" y="1751.3359">Tile</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="184" x2="226" y1="1816.0098" y2="1816.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="226" x2="226" y1="1816.0098" y2="1829.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="185" x2="226" y1="1829.0098" y2="1829.0098"/><polygon fill="#A80036" points="195,1825.0098,185,1829.0098,195,1833.0098,191,1829.0098" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="191" y="1780.6465">_backfillDEM()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="191" y="1795.957">copy 1px buffer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="191" y="1811.2676">from neigboring tiles</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="346" x2="388" y1="1858.3203" y2="1858.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="388" x2="388" y1="1858.3203" y2="1871.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="347" x2="388" y1="1871.3203" y2="1871.3203"/><polygon fill="#A80036" points="357,1867.3203,347,1871.3203,357,1875.3203,353,1871.3203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="353" y="1853.5781">fire('data', {dataType: 'source'})</text><polygon fill="#A80036" points="195,1881.3203,185,1885.3203,195,1889.3203,191,1885.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="189" x2="345" y1="1885.3203" y2="1885.3203"/><polygon fill="#A80036" points="58,1895.3203,48,1899.3203,58,1903.3203,54,1899.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="52" x2="183" y1="1899.3203" y2="1899.3203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="47" x2="89" y1="1928.6309" y2="1928.6309"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="89" x2="89" y1="1928.6309" y2="1941.6309"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="89" y1="1941.6309" y2="1941.6309"/><polygon fill="#A80036" points="58,1937.6309,48,1941.6309,58,1945.6309,54,1941.6309" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="54" y="1923.8887">fire('sourcedata')</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="47" x2="89" y1="1970.9414" y2="1970.9414"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="89" x2="89" y1="1970.9414" y2="1983.9414"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="89" y1="1983.9414" y2="1983.9414"/><polygon fill="#A80036" points="58,1979.9414,48,1983.9414,58,1987.9414,54,1983.9414" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="54" y="1966.1992">_update</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="47" x2="89" y1="2013.252" y2="2013.252"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="89" x2="89" y1="2013.252" y2="2026.252"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="89" y1="2026.252" y2="2026.252"/><polygon fill="#A80036" points="58,2022.252,48,2026.252,58,2030.252,54,2026.252" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="54" y="2008.5098">triggerRepaint()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="47" x2="89" y1="2055.5625" y2="2055.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="89" x2="89" y1="2055.5625" y2="2068.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="89" y1="2068.5625" y2="2068.5625"/><polygon fill="#A80036" points="58,2064.5625,48,2068.5625,58,2072.5625,54,2068.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="54" y="2050.8203">_render()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="47" x2="89" y1="2097.873" y2="2097.873"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="89" x2="89" y1="2097.873" y2="2110.873"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="89" y1="2110.873" y2="2110.873"/><polygon fill="#A80036" points="58,2106.873,48,2110.873,58,2114.873,54,2110.873" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="54" y="2093.1309">render new frame</text><!--
@startuml
participant map
participant source_cache
participant source
participant ajax
participant "glyph/image\nmanager"
box worker
participant worker
participant worker_source
participant worker_tile
participant bucket
participant worker_ajax
end box

map->source_cache: update(transform)
source_cache->source_cache: compute\ncovering\ntiles
loop for each missing tile
source_cache->source: loadTile(tile, callback)
alt raster_tile_source
source->ajax: getImage
else image_source
source->ajax: getImage\n(once)
else raster_dem_tile_source
source->ajax: getImage()
source->worker: loadDEMTile()
worker->worker: add 1px buffer
worker- ->source: DEMData
else vector_tile_source/geojson_source
source->worker: loadTile()
worker->worker_source: loadVectorTile()
alt vector_tile_source
worker_source->worker_ajax: getArrayBuffer()
worker_source->worker_source: decode pbf
worker_source->worker_source: parse vector tile
else geojson_source
worker_source->worker_ajax: getJSON()
worker_source->worker_source: geojson-vt parse
worker_source->worker_source: getTile()
end
worker_source->worker_tile: parse()
loop for each "layer family"
worker_tile->worker_tile: calculate layout\nproperties
worker_tile->worker_tile: createBucket
worker_tile->bucket: populate()
bucket->bucket: compute triangles\nneeded by GPU\nfor each feature we\nhave data for
worker_tile->"glyph/image\nmanager": getGlyphs
"glyph/image\nmanager"->ajax: Fetch font PBFs
"glyph/image\nmanager"->"glyph/image\nmanager": render TinySDF glyphs
worker_tile->"glyph/image\nmanager": getImages
"glyph/image\nmanager"->ajax: Fetch icon images
"glyph/image\nmanager"- ->worker_tile: hlyph/Image dependencies
worker_tile->worker_tile: maybePrepare()
worker_tile->worker_tile: create GlyphAtlas
worker_tile->worker_tile: create ImageAtlas
worker_tile->bucket: addFeatures
worker_tile->bucket: performSymbolLayout
bucket->bucket: place characters
bucket->bucket: compute collision\nboxes
bucket->bucket: compute triangles\nneeded by GPU
end
worker_tile- ->source: callback(bucket, featureIndex, collision boxes, GlyphAtlas, ImageAtlas)
source- ->source: Tile#loadVectorData()\ndecode response
end
source- ->source_cache: Tile
source_cache- ->source_cache: _backfillDEM()\ncopy 1px buffer\nfrom neigboring tiles
source->source: fire('data', {dataType: 'source'})
source->source_cache:
source_cache->map:
map->map: fire('sourcedata')
map->map: _update
map->map: triggerRepaint()
map->map: _render()
map->map: render new frame
@enduml

PlantUML version 1.2019.06(Fri May 24 13:10:25 EDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_162-b12
Operating System: Mac OS X
OS Version: 10.15.7
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>