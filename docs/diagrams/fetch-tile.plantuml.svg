<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2089px" preserveAspectRatio="none" style="width:1300px;height:2089px;" version="1.1" viewBox="0 0 1300 2089" width="1300px" zoomAndPan="magnify"><defs><filter height="300%" id="f1dejar982hghe" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="2074.5391" style="stroke: #A80036; stroke-width: 1.0;" width="632" x="640.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="933" y="16.5684">worker</text><rect fill="#FFFFFF" filter="url(#f1dejar982hghe)" height="1511.416" style="stroke: #000000; stroke-width: 2.0;" width="1014.5" x="274" y="207.3516"/><rect fill="#FFFFFF" height="44.2656" style="stroke: none; stroke-width: 1.0;" width="1014.5" x="274" y="253.9727"/><rect fill="#FFFFFF" height="145.1973" style="stroke: none; stroke-width: 1.0;" width="1014.5" x="274" y="298.2383"/><rect fill="#FFFFFF" height="1275.332" style="stroke: none; stroke-width: 1.0;" width="1014.5" x="274" y="443.4355"/><rect fill="#FFFFFF" filter="url(#f1dejar982hghe)" height="260.1289" style="stroke: #000000; stroke-width: 2.0;" width="548.5" x="730" y="524.0117"/><rect fill="#FFFFFF" height="128.8867" style="stroke: none; stroke-width: 1.0;" width="548.5" x="730" y="655.2539"/><rect fill="#FFFFFF" filter="url(#f1dejar982hghe)" height="782.0742" style="stroke: #000000; stroke-width: 2.0;" width="805" x="417.5" y="827.4512"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="32" x2="32" y1="58.7988" y2="2023.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="169" x2="169" y1="58.7988" y2="2023.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="316" x2="316" y1="58.7988" y2="2023.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="450.5" x2="450.5" y1="58.7988" y2="2023.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="581.5" x2="581.5" y1="58.7988" y2="2023.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="677.5" x2="677.5" y1="58.7988" y2="2023.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="799" x2="799" y1="58.7988" y2="2023.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="921.5" x2="921.5" y1="58.7988" y2="2023.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1083.5" x2="1083.5" y1="58.7988" y2="2023.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1217.5" x2="1217.5" y1="58.7988" y2="2023.5625"/><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="8" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="15" y="43.8457">map</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="8" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="15" y="2043.0977">map</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="114" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="121" y="43.8457">source_cache</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="114" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="121" y="2043.0977">source_cache</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="284" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="291" y="43.8457">source</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="284" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="291" y="2043.0977">source</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="427.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="434.5" y="43.8457">ajax</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="427.5" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="434.5" y="2043.0977">ajax</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="529.5" y="6.8223"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="536.5" y="27.3574">glyph/image</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="549.5" y="43.8457">manager</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="46.9766" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="529.5" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="87" x="536.5" y="2043.0977">glyph/image</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="549.5" y="2059.5859">manager</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="644.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="651.5" y="43.8457">worker</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="62" x="644.5" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="651.5" y="2043.0977">worker</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="740" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="747" y="43.8457">worker_source</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="115" x="740" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="747" y="2043.0977">worker_source</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="874.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="881.5" y="43.8457">worker_tile</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="90" x="874.5" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="76" x="881.5" y="2043.0977">worker_tile</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1051.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1058.5" y="43.8457">bucket</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="60" x="1051.5" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="46" x="1058.5" y="2043.0977">bucket</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="1166.5" y="23.3105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="1173.5" y="43.8457">worker_ajax</text><rect fill="#FEFECE" filter="url(#f1dejar982hghe)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="98" x="1166.5" y="2022.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="1173.5" y="2043.0977">worker_ajax</text><polygon fill="#A80036" points="157,86.1094,167,90.1094,157,94.1094,161,90.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="163" y1="90.1094" y2="90.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="39" y="85.3672">update(transform)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="169" x2="211" y1="134.7305" y2="134.7305"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211" x2="211" y1="134.7305" y2="147.7305"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="170" x2="211" y1="147.7305" y2="147.7305"/><polygon fill="#A80036" points="180,143.7305,170,147.7305,180,151.7305,176,147.7305" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="176" y="114.6777">compute covering</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="27" x="176" y="129.9883">tiles</text><polygon fill="#A80036" points="304,188.3516,314,192.3516,304,196.3516,308,192.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="169" x2="310" y1="192.3516" y2="192.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="176" y="172.2988">loadTile() for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="176" y="187.6094">each missing tile</text><path d="M274,207.3516 L336,207.3516 L336,214.3516 L326,224.3516 L274,224.3516 L274,207.3516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1511.416" style="stroke: #000000; stroke-width: 2.0;" width="1014.5" x="274" y="207.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="289" y="220.9199">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="351" y="219.9863">[raster_tile_source]</text><polygon fill="#A80036" points="439,241.9727,449,245.9727,439,249.9727,443,245.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="445" y1="245.9727" y2="245.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="323" y="241.2305">getImage</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="274" x2="1288.5" y1="254.9727" y2="254.9727"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="279" y="265.6074">[image_source]</text><polygon fill="#A80036" points="439,286.2383,449,290.2383,439,294.2383,443,290.2383" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="445" y1="290.2383" y2="290.2383"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="323" y="285.4961">getImage (once)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="274" x2="1288.5" y1="299.2383" y2="299.2383"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="137" x="279" y="309.873">[raster_dem_tile_source]</text><polygon fill="#A80036" points="439,330.5039,449,334.5039,439,338.5039,443,334.5039" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="445" y1="334.5039" y2="334.5039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="323" y="329.7617">getImage()</text><polygon fill="#A80036" points="665.5,359.8145,675.5,363.8145,665.5,367.8145,669.5,363.8145" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="671.5" y1="363.8145" y2="363.8145"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="323" y="359.0723">loadDEMTile()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="677.5" x2="719.5" y1="393.125" y2="393.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="719.5" x2="719.5" y1="393.125" y2="406.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="678.5" x2="719.5" y1="406.125" y2="406.125"/><polygon fill="#A80036" points="688.5,402.125,678.5,406.125,688.5,410.125,684.5,406.125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="684.5" y="388.3828">add 1px buffer</text><polygon fill="#A80036" points="327,431.4355,317,435.4355,327,439.4355,323,435.4355" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="321" x2="676.5" y1="435.4355" y2="435.4355"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="333" y="430.6934">DEMData</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="274" x2="1288.5" y1="444.4355" y2="444.4355"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="203" x="279" y="455.0703">[vector_tile_source/geojson_source]</text><polygon fill="#A80036" points="665.5,475.7012,675.5,479.7012,665.5,483.7012,669.5,479.7012" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="671.5" y1="479.7012" y2="479.7012"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="323" y="474.959">loadTile()</text><polygon fill="#A80036" points="787.5,505.0117,797.5,509.0117,787.5,513.0117,791.5,509.0117" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="677.5" x2="793.5" y1="509.0117" y2="509.0117"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="684.5" y="504.2695">loadVectorTile()</text><path d="M730,524.0117 L792,524.0117 L792,531.0117 L782,541.0117 L730,541.0117 L730,524.0117 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="260.1289" style="stroke: #000000; stroke-width: 2.0;" width="548.5" x="730" y="524.0117"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="745" y="537.5801">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="807" y="536.6465">[vector_tile_source]</text><polygon fill="#A80036" points="1205.5,558.6328,1215.5,562.6328,1205.5,566.6328,1209.5,562.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="1211.5" y1="562.6328" y2="562.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="806.5" y="557.8906">getArrayBuffer()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="841.5" y1="591.9434" y2="591.9434"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="841.5" x2="841.5" y1="591.9434" y2="604.9434"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="800.5" x2="841.5" y1="604.9434" y2="604.9434"/><polygon fill="#A80036" points="810.5,600.9434,800.5,604.9434,810.5,608.9434,806.5,604.9434" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="806.5" y="587.2012">decode pbf</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="841.5" y1="634.2539" y2="634.2539"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="841.5" x2="841.5" y1="634.2539" y2="647.2539"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="800.5" x2="841.5" y1="647.2539" y2="647.2539"/><polygon fill="#A80036" points="810.5,643.2539,800.5,647.2539,810.5,651.2539,806.5,647.2539" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="806.5" y="629.5117">parse vector tile</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="730" x2="1278.5" y1="656.2539" y2="656.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="735" y="666.8887">[geojson_source]</text><polygon fill="#A80036" points="1205.5,687.5195,1215.5,691.5195,1205.5,695.5195,1209.5,691.5195" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="1211.5" y1="691.5195" y2="691.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="806.5" y="686.7773">getJSON()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="841.5" y1="720.8301" y2="720.8301"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="841.5" x2="841.5" y1="720.8301" y2="733.8301"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="800.5" x2="841.5" y1="733.8301" y2="733.8301"/><polygon fill="#A80036" points="810.5,729.8301,800.5,733.8301,810.5,737.8301,806.5,733.8301" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="806.5" y="716.0879">geojson-vt parse</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="841.5" y1="763.1406" y2="763.1406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="841.5" x2="841.5" y1="763.1406" y2="776.1406"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="800.5" x2="841.5" y1="776.1406" y2="776.1406"/><polygon fill="#A80036" points="810.5,772.1406,800.5,776.1406,810.5,780.1406,806.5,776.1406" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="806.5" y="758.3984">getTile()</text><polygon fill="#A80036" points="909.5,808.4512,919.5,812.4512,909.5,816.4512,913.5,812.4512" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="799.5" x2="915.5" y1="812.4512" y2="812.4512"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="806.5" y="807.709">parse()</text><path d="M417.5,827.4512 L491.5,827.4512 L491.5,834.4512 L481.5,844.4512 L417.5,844.4512 L417.5,827.4512 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="782.0742" style="stroke: #000000; stroke-width: 2.0;" width="805" x="417.5" y="827.4512"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="432.5" y="841.0195">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="506.5" y="840.0859">[for each "layer family"]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="963.5" y1="881.3828" y2="881.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="963.5" x2="963.5" y1="881.3828" y2="894.3828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922.5" x2="963.5" y1="894.3828" y2="894.3828"/><polygon fill="#A80036" points="932.5,890.3828,922.5,894.3828,932.5,898.3828,928.5,894.3828" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="928.5" y="861.3301">calculate layout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="928.5" y="876.6406">properties</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="963.5" y1="923.6934" y2="923.6934"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="963.5" x2="963.5" y1="923.6934" y2="936.6934"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922.5" x2="963.5" y1="936.6934" y2="936.6934"/><polygon fill="#A80036" points="932.5,932.6934,922.5,936.6934,932.5,940.6934,928.5,936.6934" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="80" x="928.5" y="918.9512">createBucket</text><polygon fill="#A80036" points="1071.5,962.0039,1081.5,966.0039,1071.5,970.0039,1075.5,966.0039" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="1077.5" y1="966.0039" y2="966.0039"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="928.5" y="961.2617">populate()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1083.5" x2="1125.5" y1="1041.2461" y2="1041.2461"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1125.5" x2="1125.5" y1="1041.2461" y2="1054.2461"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1084.5" x2="1125.5" y1="1054.2461" y2="1054.2461"/><polygon fill="#A80036" points="1094.5,1050.2461,1084.5,1054.2461,1094.5,1058.2461,1090.5,1054.2461" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="1090.5" y="990.5723">compute triangles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="1090.5" y="1005.8828">needed by GPU</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="1090.5" y="1021.1934">for each feature we</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="1090.5" y="1036.5039">have data for</text><polygon fill="#A80036" points="593,1079.5566,583,1083.5566,593,1087.5566,589,1083.5566" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="587" x2="920.5" y1="1083.5566" y2="1083.5566"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="599" y="1078.8145">getGlyphs</text><polygon fill="#A80036" points="462,1108.8672,452,1112.8672,462,1116.8672,458,1112.8672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="456" x2="581" y1="1112.8672" y2="1112.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="468" y="1108.125">Fetch font\bPBFs</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="582" x2="624" y1="1142.1777" y2="1142.1777"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="624" x2="624" y1="1142.1777" y2="1155.1777"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="583" x2="624" y1="1155.1777" y2="1155.1777"/><polygon fill="#A80036" points="593,1151.1777,583,1155.1777,593,1159.1777,589,1155.1777" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="589" y="1137.4355">TinySDF</text><polygon fill="#A80036" points="593,1180.4883,583,1184.4883,593,1188.4883,589,1184.4883" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="587" x2="920.5" y1="1184.4883" y2="1184.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="599" y="1179.7461">getImages</text><polygon fill="#A80036" points="462,1225.1094,452,1229.1094,462,1233.1094,458,1229.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="456" x2="581" y1="1229.1094" y2="1229.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="468" y="1209.0566">Fetch icon</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="468" y="1224.3672">images</text><polygon fill="#A80036" points="909.5,1254.4199,919.5,1258.4199,909.5,1262.4199,913.5,1258.4199" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="582" x2="915.5" y1="1258.4199" y2="1258.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="589" y="1253.6777">hlyph/Image dependencies</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="963.5" y1="1287.7305" y2="1287.7305"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="963.5" x2="963.5" y1="1287.7305" y2="1300.7305"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922.5" x2="963.5" y1="1300.7305" y2="1300.7305"/><polygon fill="#A80036" points="932.5,1296.7305,922.5,1300.7305,932.5,1304.7305,928.5,1300.7305" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="928.5" y="1282.9883">maybePrepare()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="963.5" y1="1330.041" y2="1330.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="963.5" x2="963.5" y1="1330.041" y2="1343.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922.5" x2="963.5" y1="1343.041" y2="1343.041"/><polygon fill="#A80036" points="932.5,1339.041,922.5,1343.041,932.5,1347.041,928.5,1343.041" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="928.5" y="1325.2988">create GlyphAtlas</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="963.5" y1="1372.3516" y2="1372.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="963.5" x2="963.5" y1="1372.3516" y2="1385.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="922.5" x2="963.5" y1="1385.3516" y2="1385.3516"/><polygon fill="#A80036" points="932.5,1381.3516,922.5,1385.3516,932.5,1389.3516,928.5,1385.3516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="928.5" y="1367.6094">create ImageAtlas</text><polygon fill="#A80036" points="1071.5,1410.6621,1081.5,1414.6621,1071.5,1418.6621,1075.5,1414.6621" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="1077.5" y1="1414.6621" y2="1414.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="928.5" y="1409.9199">addFeatures</text><polygon fill="#A80036" points="1071.5,1439.9727,1081.5,1443.9727,1071.5,1447.9727,1075.5,1443.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921.5" x2="1077.5" y1="1443.9727" y2="1443.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="928.5" y="1439.2305">performSymbolLayout</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1083.5" x2="1125.5" y1="1473.2832" y2="1473.2832"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1125.5" x2="1125.5" y1="1473.2832" y2="1486.2832"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1084.5" x2="1125.5" y1="1486.2832" y2="1486.2832"/><polygon fill="#A80036" points="1094.5,1482.2832,1084.5,1486.2832,1094.5,1490.2832,1090.5,1486.2832" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="1090.5" y="1468.541">place characters</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1083.5" x2="1125.5" y1="1530.9043" y2="1530.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1125.5" x2="1125.5" y1="1530.9043" y2="1543.9043"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1084.5" x2="1125.5" y1="1543.9043" y2="1543.9043"/><polygon fill="#A80036" points="1094.5,1539.9043,1084.5,1543.9043,1094.5,1547.9043,1090.5,1543.9043" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="1090.5" y="1510.8516">compute collision</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="1090.5" y="1526.1621">boxes</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1083.5" x2="1125.5" y1="1588.5254" y2="1588.5254"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1125.5" x2="1125.5" y1="1588.5254" y2="1601.5254"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1084.5" x2="1125.5" y1="1601.5254" y2="1601.5254"/><polygon fill="#A80036" points="1094.5,1597.5254,1084.5,1601.5254,1094.5,1605.5254,1090.5,1601.5254" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="1090.5" y="1568.4727">compute triangles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="1090.5" y="1583.7832">needed by GPU</text><polygon fill="#A80036" points="327,1633.8359,317,1637.8359,327,1641.8359,323,1637.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="321" x2="920.5" y1="1637.8359" y2="1637.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="333" y="1633.0938">callback(bucket, featureIndex, collision boxes, GlyphAtlas, ImageAtlas)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="358" y1="1697.7676" y2="1697.7676"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="358" x2="358" y1="1697.7676" y2="1710.7676"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="317" x2="358" y1="1710.7676" y2="1710.7676"/><polygon fill="#A80036" points="327,1706.7676,317,1710.7676,327,1714.7676,323,1710.7676" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="323" y="1662.4043">loadVectorData()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="323" y="1677.7148">decode</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="323" y="1693.0254">response</text><polygon fill="#A80036" points="180,1743.0781,170,1747.0781,180,1751.0781,176,1747.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="174" x2="315" y1="1747.0781" y2="1747.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="186" y="1742.3359">Tile</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="169" x2="211" y1="1807.0098" y2="1807.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="211" x2="211" y1="1807.0098" y2="1820.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="170" x2="211" y1="1820.0098" y2="1820.0098"/><polygon fill="#A80036" points="180,1816.0098,170,1820.0098,180,1824.0098,176,1820.0098" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="176" y="1771.6465">_backfillDEM()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="176" y="1786.957">copy 1px buffer</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="176" y="1802.2676">from neigboring tiles</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="358" y1="1879.9414" y2="1879.9414"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="358" x2="358" y1="1879.9414" y2="1892.9414"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="317" x2="358" y1="1892.9414" y2="1892.9414"/><polygon fill="#A80036" points="327,1888.9414,317,1892.9414,327,1896.9414,323,1892.9414" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="323" y="1844.5781">fire('data', {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="331" y="1859.8887">dataType: 'source'</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="323" y="1875.1992">})</text><polygon fill="#A80036" points="180,1902.9414,170,1906.9414,180,1910.9414,176,1906.9414" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="174" x2="315" y1="1906.9414" y2="1906.9414"/><polygon fill="#A80036" points="43,1916.9414,33,1920.9414,43,1924.9414,39,1920.9414" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="37" x2="168" y1="1920.9414" y2="1920.9414"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="74" y1="1950.252" y2="1950.252"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="74" y1="1950.252" y2="1963.252"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="33" x2="74" y1="1963.252" y2="1963.252"/><polygon fill="#A80036" points="43,1959.252,33,1963.252,43,1967.252,39,1963.252" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="39" y="1945.5098">fire('sourcedata')</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="32" x2="74" y1="1992.5625" y2="1992.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="74" x2="74" y1="1992.5625" y2="2005.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="33" x2="74" y1="2005.5625" y2="2005.5625"/><polygon fill="#A80036" points="43,2001.5625,33,2005.5625,43,2009.5625,39,2005.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="109" x="39" y="1987.8203">render new frame</text><!--
@startuml
participant map
participant source_cache
participant source
participant ajax
participant "glyph/image\nmanager"
box worker
participant worker
participant worker_source
participant worker_tile
participant bucket
participant worker_ajax
end box

map->source_cache: update(transform)
source_cache->source_cache: compute covering\ntiles
source_cache->source: loadTile() for\neach missing tile
alt raster_tile_source
source->ajax: getImage
else image_source
source->ajax: getImage (once)
else raster_dem_tile_source
source->ajax: getImage()
source->worker: loadDEMTile()
worker->worker: add 1px buffer
worker- ->source: DEMData
else vector_tile_source/geojson_source
source->worker: loadTile()
worker->worker_source: loadVectorTile()
alt vector_tile_source
worker_source->worker_ajax: getArrayBuffer()
worker_source->worker_source: decode pbf
worker_source->worker_source: parse vector tile
else geojson_source
worker_source->worker_ajax: getJSON()
worker_source->worker_source: geojson-vt parse
worker_source->worker_source: getTile()
end
worker_source->worker_tile: parse()
loop for each "layer family"
worker_tile->worker_tile: calculate layout\nproperties
worker_tile->worker_tile: createBucket
worker_tile->bucket: populate()
bucket->bucket: compute triangles\nneeded by GPU\nfor each feature we\nhave data for
worker_tile->"glyph/image\nmanager": getGlyphs
"glyph/image\nmanager"->ajax: Fetch font\bPBFs
"glyph/image\nmanager"->"glyph/image\nmanager": TinySDF
worker_tile->"glyph/image\nmanager": getImages
"glyph/image\nmanager"->ajax: Fetch icon\nimages
"glyph/image\nmanager"- ->worker_tile: hlyph/Image dependencies
worker_tile->worker_tile: maybePrepare()
worker_tile->worker_tile: create GlyphAtlas
worker_tile->worker_tile: create ImageAtlas
worker_tile->bucket: addFeatures
worker_tile->bucket: performSymbolLayout
bucket->bucket: place characters
bucket->bucket: compute collision\nboxes
bucket->bucket: compute triangles\nneeded by GPU
end
worker_tile- ->source: callback(bucket, featureIndex, collision boxes, GlyphAtlas, ImageAtlas)
source->source: loadVectorData()\ndecode\nresponse
end
source- ->source_cache: Tile
source_cache- ->source_cache: _backfillDEM()\ncopy 1px buffer\nfrom neigboring tiles
source->source: fire('data', {\n  dataType: 'source'\n})
source->source_cache:
source_cache->map:
map->map: fire('sourcedata')
map->map: render new frame
@enduml

PlantUML version 1.2019.06(Fri May 24 13:10:25 EDT 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_162-b12
Operating System: Mac OS X
OS Version: 10.15.7
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>